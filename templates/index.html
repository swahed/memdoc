<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MemDoc - Memoiren schreiben</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <!-- Main Container -->
    <div class="app-container">
        <!-- Sidebar - Chapter Navigation -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h1 class="app-title">MemDoc</h1>
                <div class="sidebar-header-buttons">
                    <button class="btn-cover-page" id="btnCoverPage" title="Titelseite bearbeiten">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M2 2h12v12H2V2zm1 1v10h10V3H3zm2 2h6v1H5V5zm0 2h6v1H5V7zm0 2h4v1H5V9z"/>
                        </svg>
                    </button>
                    <button class="btn-new-chapter" id="btnNewChapter">+ Neues Kapitel</button>
                </div>
            </div>

            <nav class="chapter-list" id="chapterList">
                <p class="empty-state">Noch keine Kapitel. Erstelle dein erstes Kapitel!</p>
            </nav>
        </aside>

        <!-- Main Editor Area -->
        <main class="editor-container">
            <!-- Editor Header -->
            <header class="editor-header">
                <input
                    type="text"
                    class="chapter-title-input"
                    id="chapterTitle"
                    placeholder="Kapiteltitel"
                    disabled
                />
                <input
                    type="text"
                    class="chapter-subtitle-input"
                    id="chapterSubtitle"
                    placeholder="Untertitel (optional)"
                    disabled
                />
            </header>

            <!-- Formatting Toolbar -->
            <div class="formatting-toolbar" id="formattingToolbar">
                <button class="format-btn" id="btnBold" title="Fett (Strg+B)" disabled>
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M4 2h5a3 3 0 0 1 0 6H4zm0 6h6a3 3 0 0 1 0 6H4z"/>
                    </svg>
                </button>
                <button class="format-btn" id="btnItalic" title="Kursiv (Strg+I)" disabled>
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M10 2h4l-6 12H4l6-12z"/>
                    </svg>
                </button>
                <button class="format-btn" id="btnClearFormat" title="Formatierung entfernen" disabled>
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="3" y1="3" x2="13" y2="13"/>
                        <line x1="13" y1="3" x2="3" y2="13"/>
                    </svg>
                </button>
                <div class="toolbar-separator"></div>
                <button class="format-btn" id="btnH1" title="√úberschrift 1" disabled>H1</button>
                <button class="format-btn" id="btnH2" title="√úberschrift 2" disabled>H2</button>
                <button class="format-btn" id="btnH3" title="√úberschrift 3" disabled>H3</button>
                <div class="toolbar-separator"></div>
                <button class="format-btn" id="btnInsertImage" title="Bild einf√ºgen" disabled>
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M2 3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3zm11 1H3v6.5l2.5-2.5 1.5 1.5 3-3 3 3V4zm-9 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/>
                    </svg>
                </button>
                <div class="toolbar-separator"></div>
                <button class="format-btn" id="btnPreview" title="Kapitel-Vorschau" disabled>
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 2c3.5 0 6.5 2.5 8 6-1.5 3.5-4.5 6-8 6s-6.5-2.5-8-6c1.5-3.5 4.5-6 8-6zm0 10c2 0 3.5-1.5 3.5-3.5S10 5 8 5 4.5 6.5 4.5 8.5 6 12 8 12zm0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2z"/>
                    </svg>
                </button>
                <button class="format-btn" id="btnExportPDF" title="Als PDF exportieren" disabled>
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 10l-4-4h3V2h2v4h3l-4 4zm6 2v2H2v-2h1v1h10v-1h1z"/>
                    </svg>
                </button>
            </div>

            <!-- Editor Content -->
            <div class="editor-content">
                <textarea
                    class="markdown-editor"
                    id="editor"
                    placeholder="Beginne deine Memoiren zu schreiben...

Du kannst einfache Formatierung verwenden:
**fett** f√ºr fetten Text
*kursiv* f√ºr kursiven Text
# √úberschrift f√ºr Abschnitts√ºberschriften"
                    disabled
                ></textarea>
            </div>

            <!-- Status Bar -->
            <footer class="status-bar">
                <span class="status-indicator" id="saveStatus">Bereit</span>
                <span class="word-count" id="wordCount">0 W√∂rter</span>
            </footer>
        </main>

        <!-- Writing Prompts Sidebar -->
        <aside class="prompts-sidebar" id="promptsSidebar">
            <div class="prompts-header">
                <h3>Schreibanregungen</h3>
                <button class="btn-close-prompts" id="btnClosePrompts">&times;</button>
            </div>
            <div class="prompts-content" id="promptsContent">
                <p class="loading">Lade Schreibanregungen...</p>
            </div>
        </aside>
    </div>

    <!-- Toggle Prompts Button (Fixed) -->
    <button class="btn-toggle-prompts" id="btnTogglePrompts" title="Schreibanregungen ein-/ausblenden">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor">
            <path d="M3 10h14M3 5h14M3 15h14" stroke-width="2" stroke-linecap="round"/>
        </svg>
    </button>

    <!-- Image Upload Modal -->
    <div class="modal-overlay" id="imageUploadModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Bild einf√ºgen</h3>
                <button class="btn-close-modal" id="btnCloseImageModal">&times;</button>
            </div>

            <div class="modal-body">
                <!-- Drag-drop upload area -->
                <div class="upload-dropzone" id="uploadDropzone">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"/>
                    </svg>
                    <p>Bild hierher ziehen oder klicken zum Durchsuchen</p>
                    <p class="upload-hint">JPG, PNG, GIF, WebP - Max. 20MB</p>
                    <input type="file" accept="image/*" id="imageFileInput" hidden>
                </div>

                <!-- Preview area (hidden initially) -->
                <div class="upload-preview" id="uploadPreview" hidden>
                    <img id="previewImage" src="" alt="Vorschau">

                    <!-- Image info -->
                    <div class="image-info">
                        <div class="info-row">
                            <strong>Datei:</strong> <span id="infoFilename"></span>
                        </div>
                        <div class="info-row">
                            <strong>Gr√∂√üe:</strong> <span id="infoFileSize"></span>
                        </div>
                        <div class="info-row">
                            <strong>Abmessungen:</strong> <span id="infoDimensions"></span>
                        </div>
                    </div>

                    <!-- Warnings -->
                    <div id="imageWarnings" class="warnings"></div>

                    <!-- Image options -->
                    <div class="image-options">
                        <div class="option-group">
                            <label for="imagePosition">Position:</label>
                            <select id="imagePosition">
                                <option value="center">Zentriert</option>
                                <option value="left">Links (Text umflie√üt)</option>
                                <option value="right">Rechts (Text umflie√üt)</option>
                                <option value="full">Volle Breite</option>
                            </select>
                        </div>

                        <div class="option-group">
                            <label for="imageSize">Anzeigegr√∂√üe:</label>
                            <select id="imageSize">
                                <option value="small">Klein (300px)</option>
                                <option value="medium" selected>Mittel (500px)</option>
                                <option value="large">Gro√ü (700px)</option>
                                <option value="full">Volle Breite</option>
                            </select>
                        </div>

                        <div class="option-group full-width">
                            <label for="imageCaption">Bildunterschrift (optional):</label>
                            <input type="text" id="imageCaption" placeholder="Beschreibe das Foto...">
                        </div>
                    </div>

                    <!-- Helpful tips -->
                    <div class="image-tips">
                        <h4>üí° Tipps f√ºr beste Ergebnisse:</h4>
                        <ul>
                            <li>Verwende Originalfotos von Kamera/Scanner (keine Screenshots)</li>
                            <li>Ziele auf mindestens 1500 Pixel Breite f√ºr gute Druckqualit√§t</li>
                            <li>Mittlere Gr√∂√üe (500px) funktioniert gut f√ºr die meisten Memoiren-Fotos</li>
                            <li>JPG-Format ist am besten f√ºr Fotos, PNG f√ºr Diagramme</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Modal actions -->
            <div class="modal-actions">
                <button class="btn-secondary" id="btnCancelUpload">Abbrechen</button>
                <button class="btn-primary" id="btnInsertImageToEditor" disabled>Bild einf√ºgen</button>
            </div>
        </div>
    </div>

    <!-- Preview Modal -->
    <div class="modal-overlay" id="previewModal">
        <div class="modal-content preview-modal-content">
            <div class="modal-header">
                <h3>Kapitel-Vorschau</h3>
                <button class="btn-close-modal" id="btnClosePreview">&times;</button>
            </div>

            <div class="modal-body preview-body">
                <iframe id="previewFrame" sandbox="allow-same-origin"></iframe>
            </div>

            <div class="modal-actions">
                <button class="btn-secondary" id="btnClosePreviewBottom">Schlie√üen</button>
                <button class="btn-primary" id="btnExportFromPreview">Als PDF exportieren</button>
            </div>
        </div>
    </div>

    <!-- Cover Page Modal -->
    <div class="modal-overlay" id="coverPageModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Titelseite bearbeiten</h3>
                <button class="btn-close-modal" id="btnCloseCoverModal">&times;</button>
            </div>

            <div class="modal-body">
                <div class="cover-editor">
                    <div class="form-group">
                        <label for="coverTitleInput">Titel</label>
                        <input type="text" id="coverTitleInput" class="form-input" placeholder="Titel deiner Memoiren">
                    </div>

                    <div class="form-group">
                        <label for="coverSubtitleInput">Untertitel</label>
                        <input type="text" id="coverSubtitleInput" class="form-input" placeholder="Untertitel (optional)">
                    </div>

                    <div class="form-group">
                        <label for="coverAuthorInput">Autor</label>
                        <input type="text" id="coverAuthorInput" class="form-input" placeholder="Dein Name">
                    </div>

                    <div class="form-group">
                        <label>Titelbild (optional)</label>
                        <div class="cover-image-upload">
                            <input type="file" id="coverImageInput" accept="image/*" hidden>
                            <button class="btn-secondary" id="btnChooseCoverImage">Titelbild w√§hlen</button>
                            <button class="btn-secondary" id="btnRemoveCoverImage" style="display: none;">Titelbild entfernen</button>
                        </div>
                        <div id="coverImagePreview" class="cover-image-preview" style="display: none;">
                            <img id="coverImagePreviewImg" src="" alt="Titelbild">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Hintergrundfarbe</label>
                        <div class="color-picker-container">
                            <div id="suggestedColors" class="suggested-colors" style="display: none;">
                                <p class="suggested-colors-label">Vorgeschlagene Farben:</p>
                                <div id="colorSuggestions" class="color-suggestions"></div>
                            </div>
                            <div class="custom-color-picker">
                                <input type="color" id="coverColorInput" value="#f5f5f5">
                                <span class="color-picker-label">Eigene Farbe w√§hlen</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Live Preview -->
                <div class="cover-preview-container">
                    <h4>Vorschau</h4>
                    <div class="cover-preview" id="coverPreview">
                        <div class="cover-preview-content">
                            <div id="coverPreviewImage" class="cover-preview-image" style="display: none;"></div>
                            <div class="cover-preview-text">
                                <h1 id="coverPreviewTitle" class="cover-preview-title">Titel deiner Memoiren</h1>
                                <h2 id="coverPreviewSubtitle" class="cover-preview-subtitle"></h2>
                                <p id="coverPreviewAuthor" class="cover-preview-author">Dein Name</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-actions">
                <button class="btn-secondary" id="btnCancelCover">Abbrechen</button>
                <button class="btn-primary" id="btnSaveCover">Speichern</button>
            </div>
        </div>
    </div>

    <script src="/static/js/i18n.js"></script>
    <script src="/static/js/api.js"></script>
    <script src="/static/js/editor.js"></script>
    <script src="/static/js/app.js"></script>
</body>
</html>
